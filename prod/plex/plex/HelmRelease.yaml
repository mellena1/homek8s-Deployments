---
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: plex
  namespace: plex
spec:
  releaseName: plex
  chart:
    repository: https://charts.andrewmellen.org/
    name: kube-plex
    version: 0.2.4
  values:
    image:
      repository: plexinc/pms-docker
      tag: "1.18.0.1913-e5cc93306"
    kubePlex:
      enabled: true
      image:
        repository: quay.io/munnerz/kube-plex
        tag: "latest"
    claimToken:
      secret: claim-token
    persistence:
      data:
        claimName: plex
      config:
        claimName: plex-config
      transcode:
        enabled: true
        claimName: plex-transcode
    service:
      type: NodePort
      nodePort: 32400
    ingress:
      enabled: true
      annotations:
        ingress.kubernetes.io/ssl-redirect: "true"
        kubernetes.io/tls-acme: "true"
        certmanager.k8s.io/cluster-issuer: letsencrypt-prod
        kubernetes.io/ingress.class: "nginx"
      tls:
      - hosts:
        - plex.andrewmellen.org
        secretName: plex-letsencrypt-prod
      hosts:
      - plex.andrewmellen.org
...
